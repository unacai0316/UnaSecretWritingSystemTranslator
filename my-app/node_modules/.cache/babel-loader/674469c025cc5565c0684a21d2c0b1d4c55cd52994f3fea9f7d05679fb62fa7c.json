{"ast":null,"code":"var varint = require('varint');\nvar stream = require('readable-stream');\nvar inherits = require('inherits');\nvar Decoder = function (opts) {\n  if (!(this instanceof Decoder)) return new Decoder(opts);\n  stream.Transform.call(this);\n  this._destroyed = false;\n  this._missing = 0;\n  this._message = null;\n  this._limit = opts && opts.limit || 0;\n  this._allowEmpty = !!(opts && opts.allowEmpty);\n  this._prefix = Buffer.allocUnsafe(this._limit ? varint.encodingLength(this._limit) : 100);\n  this._ptr = 0;\n  if (this._allowEmpty) {\n    this._readableState.highWaterMark = 16;\n    this._readableState.objectMode = true;\n  }\n};\ninherits(Decoder, stream.Transform);\nDecoder.prototype._push = function (message) {\n  this._ptr = 0;\n  this._missing = 0;\n  this._message = null;\n  this.push(message);\n};\nDecoder.prototype._parseLength = function (data, offset) {\n  for (offset; offset < data.length; offset++) {\n    if (this._ptr >= this._prefix.length) return this._prefixError(data);\n    this._prefix[this._ptr++] = data[offset];\n    if (!(data[offset] & 0x80)) {\n      this._missing = varint.decode(this._prefix);\n      if (this._limit && this._missing > this._limit) return this._prefixError(data);\n      if (!this._missing && this._allowEmpty) this._push(Buffer.alloc(0));\n      this._ptr = 0;\n      return offset + 1;\n    }\n  }\n  return data.length;\n};\nDecoder.prototype._prefixError = function (data) {\n  this.destroy(new Error('Message is larger than max length'));\n  return data.length;\n};\nDecoder.prototype._parseMessage = function (data, offset) {\n  var free = data.length - offset;\n  var missing = this._missing;\n  if (!this._message) {\n    if (missing <= free) {\n      // fast track - no copy\n      this._push(data.slice(offset, offset + missing));\n      return offset + missing;\n    }\n    this._message = Buffer.allocUnsafe(missing);\n  }\n\n  // TODO: add opt-in \"partial mode\" to completely avoid copys\n  data.copy(this._message, this._ptr, offset, offset + missing);\n  if (missing <= free) {\n    this._push(this._message);\n    return offset + missing;\n  }\n  this._missing -= free;\n  this._ptr += free;\n  return data.length;\n};\nDecoder.prototype._transform = function (data, enc, cb) {\n  var offset = 0;\n  while (!this._destroyed && offset < data.length) {\n    if (this._missing) offset = this._parseMessage(data, offset);else offset = this._parseLength(data, offset);\n  }\n  cb();\n};\nDecoder.prototype.destroy = function (err) {\n  if (this._destroyed) return;\n  this._destroyed = true;\n  if (err) this.emit('error', err);\n  this.emit('close');\n};\nmodule.exports = Decoder;","map":{"version":3,"names":["varint","require","stream","inherits","Decoder","opts","Transform","call","_destroyed","_missing","_message","_limit","limit","_allowEmpty","allowEmpty","_prefix","Buffer","allocUnsafe","encodingLength","_ptr","_readableState","highWaterMark","objectMode","prototype","_push","message","push","_parseLength","data","offset","length","_prefixError","decode","alloc","destroy","Error","_parseMessage","free","missing","slice","copy","_transform","enc","cb","err","emit","module","exports"],"sources":["/Users/tsaiyunzhen/my-react-app/my-app/node_modules/length-prefixed-stream/decode.js"],"sourcesContent":["var varint = require('varint')\nvar stream = require('readable-stream')\nvar inherits = require('inherits')\n\nvar Decoder = function (opts) {\n  if (!(this instanceof Decoder)) return new Decoder(opts)\n  stream.Transform.call(this)\n\n  this._destroyed = false\n  this._missing = 0\n  this._message = null\n  this._limit = (opts && opts.limit) || 0\n  this._allowEmpty = !!(opts && opts.allowEmpty)\n  this._prefix = Buffer.allocUnsafe(this._limit ? varint.encodingLength(this._limit) : 100)\n  this._ptr = 0\n\n  if (this._allowEmpty) {\n    this._readableState.highWaterMark = 16\n    this._readableState.objectMode = true\n  }\n}\n\ninherits(Decoder, stream.Transform)\n\nDecoder.prototype._push = function (message) {\n  this._ptr = 0\n  this._missing = 0\n  this._message = null\n  this.push(message)\n}\n\nDecoder.prototype._parseLength = function (data, offset) {\n  for (offset; offset < data.length; offset++) {\n    if (this._ptr >= this._prefix.length) return this._prefixError(data)\n    this._prefix[this._ptr++] = data[offset]\n    if (!(data[offset] & 0x80)) {\n      this._missing = varint.decode(this._prefix)\n      if (this._limit && this._missing > this._limit) return this._prefixError(data)\n      if (!this._missing && this._allowEmpty) this._push(Buffer.alloc(0))\n      this._ptr = 0\n      return offset + 1\n    }\n  }\n  return data.length\n}\n\nDecoder.prototype._prefixError = function (data) {\n  this.destroy(new Error('Message is larger than max length'))\n  return data.length\n}\n\nDecoder.prototype._parseMessage = function (data, offset) {\n  var free = data.length - offset\n  var missing = this._missing\n\n  if (!this._message) {\n    if (missing <= free) { // fast track - no copy\n      this._push(data.slice(offset, offset + missing))\n      return offset + missing\n    }\n    this._message = Buffer.allocUnsafe(missing)\n  }\n\n  // TODO: add opt-in \"partial mode\" to completely avoid copys\n  data.copy(this._message, this._ptr, offset, offset + missing)\n\n  if (missing <= free) {\n    this._push(this._message)\n    return offset + missing\n  }\n\n  this._missing -= free\n  this._ptr += free\n\n  return data.length\n}\n\nDecoder.prototype._transform = function (data, enc, cb) {\n  var offset = 0\n\n  while (!this._destroyed && offset < data.length) {\n    if (this._missing) offset = this._parseMessage(data, offset)\n    else offset = this._parseLength(data, offset)\n  }\n\n  cb()\n}\n\nDecoder.prototype.destroy = function (err) {\n  if (this._destroyed) return\n  this._destroyed = true\n  if (err) this.emit('error', err)\n  this.emit('close')\n}\n\nmodule.exports = Decoder\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}